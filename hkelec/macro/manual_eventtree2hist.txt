manual for triggered adc data

In hkpd@hkdaq
0. hkpd@hkdaq:~$ mkdir /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX

1. hkpd@hkdaq:~$ . ~/setup_hkelec.sh  ## set up

2. hkpd@hkdaq:~/hkelec/DiscreteSoftware/data$ /home/hkpd/hkelec/pmt-scan/scripts/ScanManager.py -i /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX/LDhkelec_xxx -l 20 --trgch 4 ... ## Masurement (make binary file)

    usage: ScanManager.py [-h] [-i RUNID] [-l LENGTH] [--trgch TRGCH] [--dBlist [DBLIST ...]] [--dBstep DBSTEP DBSTEP DBSTEP]
                        [--HVlist [HVLIST ...]] [--HVstep HVSTEP HVSTEP HVSTEP] [--threlist [THRELIST ...]]
                        [--threstep THRESTEP THRESTEP THRESTEP] [--threpreset] [--threpreset2] [--threpreset3]
                        [--gatelist [GATELIST ...]] [--gatestep GATESTEP GATESTEP GATESTEP] [--deadlist [DEADLIST ...]]
                        [--deadstep DEADSTEP DEADSTEP DEADSTEP] [--dryrun]

    Take series of runs while scanning HV/dB/threshold/gate width/veto width settings. Give the list or start/stop/step of
    parameters you want to scan.

    options:
    -h, --help            show this help message and exit
    -i RUNID, --runid RUNID
                            Name or identification of this run
    -l LENGTH, --length LENGTH
                            Length of the data-taking in second.
    --trgch TRGCH         Trigger Channel
    --dBlist [DBLIST ...]
                            list of attenuation factors (dB)
    --dBstep DBSTEP DBSTEP DBSTEP
                            [start, end, step] of attenuation factors (dB)
    --HVlist [HVLIST ...]
                            list of HV values (V)
    --HVstep HVSTEP HVSTEP HVSTEP
                            [start, end, step] of HV values (V)
    --threlist [THRELIST ...]
                            list of threshold values (mV, absolute value)
    --threstep THRESTEP THRESTEP THRESTEP
                            [start, end, step] of threshold values (mV)
    --threpreset          Preset threshold scan values (30 runs)
    --threpreset2         Preset threshold scan values #2 (20 runs, complementary to #1)
    --threpreset3         Preset threshold scan values #3, in finer steps. (95 runs, includes #1&2)
    --gatelist [GATELIST ...]
                            list of integration gate width in DAC (-> 9*DAC + 33 ns)
    --gatestep GATESTEP GATESTEP GATESTEP
                            [start, end, step] of integration gate width in DAC
    --deadlist [DEADLIST ...]
                            list of veto width in DAC (-> 10*DAC ns)
    --deadstep DEADSTEP DEADSTEP DEADSTEP
                            [start, end, step] of veto width in DAC
    --dryrun              Shows the list of runs to be taken without actually affecting the system

2.5. hkpd@hkdaq:~/hkelec/DiscreteSoftware/data$ /home/hkpd/hkelec/DiscreteSoftware/RunManager.py -p -i /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX/hkelec_pedestal -l 40  

    hkpd@hkdaq:~$ . setup_hkelec.sh
    hkpd@hkdaq:~/hkelec/DiscreteSoftware$ RunManager.py -h
    usage: RunManager.py [-h] [-p] [-n] [-x] [-c CHS [CHS ...]] [-l LENGTH] [-i RUNID] [—trgch TRGCH] [—dummy]

    Script that manages a single "run", which is a set of the data taken in a costant configuration

    options:
    -h, —help show this help message and exit
    -p, —pedestal Enable pedestal mode
    -n, —normal-run Normal run enabling pedestal 10 Hz
    -x, —cal Enable calibrator mode
    -c CHS [CHS ...], —chs CHS [CHS ...]
    Channels to be acquired. Defautl all channels
    -l LENGTH, —length LENGTH
    Length of the data-taking in second. For dummy runs, this is the timeout and 0
    indicates no timeout
    -i RUNID, —runid RUNID
    Name or identification of this run
    —trgch TRGCH Trigger Channel
    --dummy Flag to start a dummy run

3. hkpd@hkdaq:~/hkelec/DiscreteSoftware/data$ ~/hkelec/DiscreteSoftware/data/analyze_multi.sh /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX 1  ## .bin -> eventtree.root 

3.5. hkpd@hkdaq:~/hkelec/DiscreteSoftware/data$ ~/hkelec/DiscreteSoftware/data/analyze.sh /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX/hkelec_pedestal ## .bin -> hithist.root

4. hkpd@hkdaq:~/hkelec/DiscreteSoftware/data$ ~/hkelec/DiscreteSoftware/Analysis/macro/eventtree2hist_multi.sh ~/hkelec/DiscreteSoftware/data/2025XXXX  ## eventtree.root -> eventhist.root

    # どの項目をヒストグラムにするかは要編集
    # ヒットの採用条件やヒストグラムの表示範囲に注意

5. hkpd@hkdaq:~/hkelec/DiscreteSoftware/Analysis/macro$ ~/hkelec/DiscreteSoftware/Analysis/macro/run_gausfit_batch.sh /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX ## fit hist of eventhist.root and make table

5'. hkpd@hkdaq:~/hkelec/DiscreteSoftware/Analysis/macro$ ~/hkelec/DiscreteSoftware/Analysis/macro/run_peakfinder_batch.sh /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX ## find peak of eventhist.root and make table

6. hkpd@hkdaq:~$ ~/hkelec/DiscreteSoftware/Analysis/macro/run_hv_fitter.sh /home/hkpd/hkelec/DiscreteSoftware/data/20251016/100pe selected 

6'. hkpd@hkdaq:~$ ~/hkelec/DiscreteSoftware/Analysis/macro/run_hv_fitter.sh /home/hkpd/hkelec/DiscreteSoftware/data/20251016/1pe subtracted 

7. hkpd@hkdaq:~$ scp -r /home/hkpd/hkelec/DiscreteSoftware/data/2025XXXX/ kishita@hep.phys.keio.ac.jp:~/data/  



memo
- eventtree2hist.C
    #ヒットの採用条件やヒストグラムの範囲に注意
    #現在はtime_diffのピークの前後50 nsを採用

- manualをAIにまとめさせる．