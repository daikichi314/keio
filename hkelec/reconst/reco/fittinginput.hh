// fittinginput.hh
#ifndef FITTINGINPUT_HH
#define FITTINGINPUT_HH
#include "TVector3.h"
#include <vector>

struct PMTData {
    int tubeid;        // ID of the PMT tube
    int mPMTid;        // ID of the m-PMT
    int mPMT_pmtid;    // ID of the PMT in m-PMT
    double t;          // Time in ns
    double x;          // X-coordinate in cm
    double y;          // Y-coordinate in cm
    double z;          // Z-coordinate in cm
    double L;          // Light intensity (charge)
    double ori_x;      // Orientation vector x-component 向きベクトルのx成分
    double ori_y;      // Orientation vector y-component 向きベクトルのy成分
    double ori_z;      // Orientation vector z-component 向きベクトルのz成分
    double center_x;   // center_x of m-PMT
    double center_y;   // center_y of m-PMT
    double center_z;   // center_z of m-PMT
    double ori_mPMT_x; // Direction vector x-component of m-PMT 
    double ori_mPMT_y; // Direction vector y-component of m-PMT
    double ori_mPMT_z; // Direction vector z-component of m-PMT
};
struct id_L {       // TODO あとでonePMTfitの引数に変更する
    int mPMT_pmtid; // ID of the PMT in m-PMT
    double L;       // Light intensity (charge)
};
const double pmtDirections[20][3] = {
    // すべてのmPMTで、mPMTの向きが-y方向になるような座標系を選択
    {0.0, 0.0, 0.0}, // dummy
    {0.587785252, -0.809016994, 0.000000000},
    {0.509036960, -0.809016994, 0.293892626},
    {0.293892626, -0.809016994, 0.509036960},
    {0.000000000, -0.809016994, 0.587785252},
    {-0.293892626, -0.809016994, 0.509036960},
    {-0.509036960, -0.809016994, 0.293892626},
    {-0.587785252, -0.809016994, 0.000000000},
    {-0.509036960, -0.809016994, -0.293892626},
    {-0.293892626, -0.809016994, -0.509036960},
    {0.000000000, -0.809016994, -0.587785252},
    {0.293892626, -0.809016994, -0.509036960},
    {0.509036960, -0.809016994, -0.293892626},
    {0.309016994, -0.951056516, 0.000000000},
    {0.154508497, -0.951056516, 0.267616567},
    {-0.154508497, -0.951056516, 0.267616567},
    {-0.309016994, -0.951056516, 0.000000000},
    {-0.154508497, -0.951056516, -0.267616567},
    {0.154508497, -0.951056516, -0.267616567},
    {0.000000000, -1.000000000, 0.000000000},
};

const double pmt19orientations[369][3] = {
    {0, 0, 0}, // dummy
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0, 1, -0},
    {-0.965926, -0, -0.258819},
    {-0.965926, -0, -0.258819},
    {-0.707107, -0, -0.707107},
    {-0.707107, -0, -0.707107},
    {-0.258819, -0, -0.965926},
    {-0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.258819, -0, -0.965926},
    {0.707107, -0, -0.707107},
    {0.707107, -0, -0.707107},
    {0.965926, -0, -0.258819},
    {0.965926, -0, -0.258819},
    {0.965926, -0, 0.258819},
    {0.965926, -0, 0.258819},
    {0.707107, -0, 0.707107},
    {0.707107, -0, 0.707107},
    {0.258819, -0, 0.965926},
    {0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.258819, -0, 0.965926},
    {-0.707107, -0, 0.707107},
    {-0.707107, -0, 0.707107},
    {-0.965926, -0, 0.258819},
    {-0.965926, -0, 0.258819},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
};

const double pmt1orientations[369][3] = {
    {0, 0, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {-1, 0, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {0, -1, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
    {1, 0, 0},
};

const double pmt4orientations[369][3] = {
    {0, 0, 0},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {-0.258819, 0, 0.965926},
    {-0.258819, 0, 0.965926},
    {-0.707107, 0, 0.707107},
    {-0.707107, 0, 0.707107},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, 0.258819},
    {-0.965926, 0, -0.258819},
    {-0.965926, 0, -0.258819},
    {-0.707107, 0, -0.707107},
    {-0.707107, 0, -0.707107},
    {-0.258819, 0, -0.965926},
    {-0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.258819, 0, -0.965926},
    {0.707107, 0, -0.707107},
    {0.707107, 0, -0.707107},
    {0.965926, 0, -0.258819},
    {0.965926, 0, -0.258819},
    {0.965926, 0, 0.258819},
    {0.965926, 0, 0.258819},
    {0.707107, 0, 0.707107},
    {0.707107, 0, 0.707107},
    {0.258819, 0, 0.965926},
    {0.258819, 0, 0.965926},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
    {0, 0, 1},
};

// 上記のマップから各PMTの向きを取得　
// 座標系をもどすのはメイン関数の方が担当
// onemPMTfitではid(mPMT_pmtid)とLだけ渡す。PMTの向きをえる関数は別で用意
// 各PMTの向きも極座標系で渡す？
// それとも、極座標→直交座標変換を、天空をn分割することで計算せずに渡せるようにして、直交座標系であつかう？
struct SensorUnit {
    int id;                  // Sensor ID (PMT ID)
    double posx, posy, posz; // Position of the sensor (in cm, rectangular coordinates)
    double dirx, diry, dirz; // Estimated direction (unit vector)
    double time;             // Detection time (in ns, recommended to be around 0 ns)
    double sigma_sintheta;   // Direction error
    double sigma_time;       // Time resolution (in ns)
	double L;
};

#endif // FITTINGINPUT_HH
