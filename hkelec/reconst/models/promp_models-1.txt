x=r,y=charge/light_powerのグラフを、pmt_num=1,x=-35,y=35の条件のもとプロットしたい。

では改めて、PMT1~4について、セル2で行ったような処理（条件付きでグラフを描写した後フィッティング）を行ってください。
ただし、PMT_num=1,2,3,4はそれぞれ、
(x,y)=(-35,35),(35,35),(-35,-35),(35,-35)
に対応しています。
何か不明な点があれば勝手に推測せず私に聞いてください。

1つのセルでよいです。また、フィット結果を最後にまとめて表示してください。
グラフはそれぞれ別々に表示した後に2*2のまとめた図もだしてください
初期値はすべて、c0=0, c1= 1600にしてください。


出力するCSVの仕様について、追加でグラフにフィッティングに反映するかどうかのフラグを追加してください。デフォルトは反映するようにしてください。
もとのグラフをこちらで観察して、外れ値だと思ったものはここで描写しないようにこちらで変更します。
そして、plot_from_csv.Cの方では、すべての点を描写はするものの、外れ値と判定されたものはフィッティングには反映しないようにし、色などをほかの点と変えて区別がつくようにしてください。

１．y = c0 + c1 * (1 - sqrt(1 - (32.5/r_from_center)^2))
によるのフィットについて、これはCharge_errを考慮していないと思います。せっかく算出しているのだから、エラーバーとして表示し、フィッティングに反映させることはできないでしょうか。
２．このジュピターファイルは、以下の電荷の期待値モデルのf(r_i),\epsilon(cos(\alpha_i))を決定することを目的としています。
Q_i^exp(A,r_i,\alpha_i) = A * f(r_i) * \epsilon(cos(\alpha_i))
ここで、QはCharge、iはPMT_num、Aはlight_powerに対応しており、r_i,\alpha_iは、csvのiごとのr_from_center,\alpha_from_centerの値です。
各PMTでのフィット結果に基づいて、いま、
f(r_i)=c0 + c1 * (1 - sqrt(1 - (32.5/r_from_center)^2))が決定していると思うので、PMTごとの関数にフィット結果を代入してこの関数を作ってください。
３．もとのCSVについて、それぞれのPMT上((x,y)=(+-35,+-35)をみたす)の各点の結果について、
x=light_power,y=chargeのグラフを作成してください。また、それぞれ直線でフィットしてください。2点しかないので2点を通る線を引ければそれでよいです。
PMTごとにグラフはまとめてください（各8枚あるはずです。）
これは、そもそもQとAが比例関係にあることを確認するためです。

以上について、何か不明な点があれば、質問してください。



１．Charge_err(pC)という列があるはずです。
２．PMTごとに違う値になると思うので、PMTごとに関数を作ってください。
３．4箇所：(-35,35), (35,35), (-35,-35), (35,-35)）について、それぞれz=87,97,...,157,162の9点（8点ではありませんでした）が恐らく存在するので、もしあれば、それぞれの点でlight_power vs Chargeのグラフをつくってください。ただし、(-35,35)上ではPMT_num=1、(35,35)上ではPMT_num=2、(-35,-35)上ではPMT_num=3、(35,-35)上ではPMT_num=4のデータのみを使ってください。
恐らく、各点で2点ずつデータが存在するはずです。

まだ不明な点があれば質問してください。


QとAが比例することを確かめるため、以下を行います。
PMTi上の点(+-35,+-35,z)について、r_from_centerから、先ほど決めたf_i(r_i)を用いて、
Charge_i/f_i(r_i)を計算し、y軸に、x軸にlight_powerをとってプロットしたグラフをPMTごとに作成してください。
また、直線でフィットして、原点を通っているかわかるようにx=0~1で描写してください。
できればCharge<20の点は外れ値として除外してください。
質問があればしてください。





では、最後の仕上げとして、元のデータフレーム内のPMT_num=iのすべてのデータについて、
Charge/(light_power*f_i(r_from_center))を計算し、y軸に、x軸にcos(\alpha_from_center)をとってプロットしたグラフをiごとに作成してください。 

何か不明な点があれば勝手に推測せず私に聞いてください。